#include <stdio.h>
#include "../header/simd/fft_simd.h"

void test_for_twiddle_forward()
{
    int size = 8;
    complex* twid = precompute_twiddle_factor(size, 0);

    // expected
    // 1.00000 0.00000
    // 0.70711 -0.70711
    // 0.00000 -1.00000
    // -0.70711 -0.70711

    for (int i = 0; i < size >> 1; i++)
    {
        printf("%f + j%f\n", twid->real[i], twid->imag[i]);
    }
    
    // received 
    // 1.000000 + j0.000000
    // 0.707107 + j-0.707107
    // 0.000000 + j-1.000000
    // -0.707107 + j-0.707107
    complex_arr_allign_16_destroy(twid);
}

void test_for_twiddle_backward()
{
    int size = 8;
    complex* twid = precompute_twiddle_factor(size, 1);

    // expected
    // 1.00000 0.00000
    // 0.70711 -0.70711
    // 0.00000 -1.00000
    // -0.70711 -0.70711

    for (int i = 0; i < size >> 1; i++)
    {
        printf("%f + j%f\n", twid->real[i], twid->imag[i]);
    }
    
    // received 
    // 1.000000 + j0.000000
    // 0.707107 + j-0.707107
    // 0.000000 + j-1.000000
    // -0.707107 + j-0.707107
    complex_arr_allign_16_destroy(twid);
}

void test_for_twiddle_forward_r4()
{
    int size = 64;
    complex* twid = precompute_twiddle_factor_radix_4(size, 0);
    // expected
    // 1.0 0.0
    // 0.9951847266721969 -0.0980171403295606
    // 0.9807852804032304 -0.19509032201612825
    // 0.9569403357322088 -0.29028467725446233
    // 0.9238795325112867 -0.3826834323650898
    // 0.881921264348355 -0.47139673682599764
    // 0.8314696123025452 -0.5555702330196022
    // 0.773010453362737 -0.6343932841636455
    // 0.7071067811865476 -0.7071067811865475
    // 0.6343932841636455 -0.773010453362737
    // 0.5555702330196023 -0.8314696123025452
    // 0.4713967368259978 -0.8819212643483549
    // 0.38268343236508984 -0.9238795325112867
    // 0.29028467725446233 -0.9569403357322089
    // 0.19509032201612833 -0.9807852804032304
    // 0.09801714032956077 -0.9951847266721968
    // w2l
    // 1.0 0.0
    // 0.9807852804032304 -0.19509032201612825
    // 0.9238795325112867 -0.3826834323650898
    // 0.8314696123025452 -0.5555702330196022
    // 0.7071067811865476 -0.7071067811865475
    // 0.5555702330196023 -0.8314696123025452
    // 0.38268343236508984 -0.9238795325112867
    // 0.19509032201612833 -0.9807852804032304
    // 6.123233995736766e-17 -1.0
    // -0.1950903220161282 -0.9807852804032304
    // -0.3826834323650897 -0.9238795325112867
    // -0.555570233019602 -0.8314696123025455
    // -0.7071067811865475 -0.7071067811865476
    // -0.8314696123025453 -0.5555702330196022
    // -0.9238795325112867 -0.3826834323650899
    // -0.9807852804032304 -0.1950903220161286
    // w3l
    // 1.0 0.0
    // 0.9569403357322088 -0.29028467725446233
    // 0.8314696123025452 -0.5555702330196022
    // 0.6343932841636455 -0.773010453362737
    // 0.38268343236508984 -0.9238795325112867
    // 0.09801714032956077 -0.9951847266721968
    // -0.1950903220161282 -0.9807852804032304
    // -0.4713967368259977 -0.881921264348355
    // -0.7071067811865475 -0.7071067811865476
    // -0.8819212643483549 -0.47139673682599786
    // -0.9807852804032304 -0.1950903220161286
    // -0.9951847266721969 0.09801714032956059
    // -0.9238795325112868 0.38268343236508967
    // -0.7730104533627371 0.6343932841636453
    // -0.5555702330196022 0.8314696123025452
    // -0.29028467725446244 0.9569403357322088



    for (int i = 0; i < (3 * size >> 2); i++)
    {
        if (i == 0)
        {
            printf("=== 0 ===\n");
            printf("=== W_l ===\n");
        }
        if (i == size >> 2)
        {
            printf("=== N / 4 ===\n");
            printf("=== W_2l ===\n");
        }

        if (i == size >> 1)
        {
            printf("=== N / 2 ===\n");
            printf("=== W_3l ===\n");
        }
        printf("%f + j%f\n", twid->real[i], twid->imag[i]);
    }

    // received
    // === 0 ===
    // === W_l ===
    // 1.000000 + j0.000000
    // 0.995185 + j-0.098017
    // 0.980785 + j-0.195090
    // 0.956940 + j-0.290285
    // 0.923880 + j-0.382683
    // 0.881921 + j-0.471397
    // 0.831470 + j-0.555570
    // 0.773010 + j-0.634393
    // 0.707107 + j-0.707107
    // 0.634393 + j-0.773010
    // 0.555570 + j-0.831470
    // 0.471397 + j-0.881921
    // 0.382683 + j-0.923880
    // 0.290285 + j-0.956940
    // 0.195090 + j-0.980785
    // 0.098017 + j-0.995185
    // === N / 4 ===
    // === W_2l ===
    // 1.000000 + j0.000000
    // 0.980785 + j-0.195090
    // 0.923880 + j-0.382683
    // 0.831470 + j-0.555570
    // 0.707107 + j-0.707107
    // 0.555570 + j-0.831470
    // 0.382683 + j-0.923880
    // 0.195090 + j-0.980785
    // 0.000000 + j-1.000000
    // -0.195090 + j-0.980785
    // -0.382683 + j-0.923880
    // -0.555570 + j-0.831470
    // -0.707107 + j-0.707107
    // -0.831470 + j-0.555570
    // -0.923880 + j-0.382683
    // -0.980785 + j-0.195090
    // === N / 2 ===
    // === W_3l ===
    // 1.000000 + j0.000000
    // 0.956940 + j-0.290285
    // 0.831470 + j-0.555570
    // 0.634393 + j-0.773010
    // 0.382683 + j-0.923880
    // 0.098017 + j-0.995185
    // -0.195090 + j-0.980785
    // -0.471397 + j-0.881921
    // -0.707107 + j-0.707107
    // -0.881921 + j-0.471397
    // -0.980785 + j-0.195090
    // -0.995185 + j0.098017
    // -0.923880 + j0.382683
    // -0.773010 + j0.634393
    // -0.555570 + j0.831470
    // -0.290285 + j0.956940

    // PASSED
}

void test_for_twiddle_backward_r4()
{
    int size = 8;
    complex* twid = precompute_twiddle_factor_radix_4(size, 1);

    // expected
    // 1.00000 0.00000
    // 0.70711 -0.70711
    // 0.00000 -1.00000
    // -0.70711 -0.70711

    for (int i = 0; i < (3 * size >> 2); i++)
    {
        if (i == 0)
        {
            printf("=== 0 ===\n");
            printf("=== W_l ===\n");
        }
        if (i == size >> 2)
        {
            printf("=== N / 4 ===\n");
            printf("=== W_2l ===\n");
        }

        if (i == size >> 1)
        {
            printf("=== N / 2 ===\n");
            printf("=== W_3l ===\n");
        }
        printf("%f + j%f\n", twid->real[i], twid->imag[i]);
    }
    
    // received 
    // 1.000000 + j0.000000
    // 0.707107 + j-0.707107
    // 0.000000 + j-1.000000
    // -0.707107 + j-0.707107
    complex_arr_allign_16_destroy(twid);
}
int main()
{
    printf("Radix 4 F\n");
    test_for_twiddle_forward_r4();
    return 0;
}